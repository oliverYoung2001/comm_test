CONFIG:
WORLD_SIZE: 8

round 0:
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
8SC0: 0.3959479331970215, REAL_BD: 2.63593431472523 GB/s, TOTAL_BD: 0.6905895373469194 GB/s, comm_vol: 0.2734375 GB
8SC1: 0.1916348934173584, REAL_BD: 3.823533262582225 GB/s, TOTAL_BD: 1.4268669714783366 GB/s, comm_vol: 0.2734375 GB
SIZE: [1, 1024, 1024, 128], in/out_dim: 2/1
8SC0: 0.5283608436584473, REAL_BD: 2.7701724398657936 GB/s, TOTAL_BD: 1.035040742635957 GB/s, comm_vol: 0.546875 GB
8SC1: 0.3006560802459717, REAL_BD: 4.013094034972803 GB/s, TOTAL_BD: 1.8189387673536905 GB/s, comm_vol: 0.546875 GB
SIZE: [1, 1024, 1024, 256], in/out_dim: 2/1
8SC0: 0.7885231971740723, REAL_BD: 2.8676271452770257 GB/s, TOTAL_BD: 1.3870866499803767 GB/s, comm_vol: 1.09375 GB
8SC1: 0.5393195152282715, REAL_BD: 4.1133079785380735 GB/s, TOTAL_BD: 2.028018584747598 GB/s, comm_vol: 1.09375 GB
SIZE: [1, 1024, 1024, 512], in/out_dim: 2/1
8SC0: 1.1301393508911133, REAL_BD: 2.933550185157718 GB/s, TOTAL_BD: 1.9356020107389051 GB/s, comm_vol: 2.1875 GB
8SC1: 0.8352036476135254, REAL_BD: 4.136748180483913 GB/s, TOTAL_BD: 2.6191217031324845 GB/s, comm_vol: 2.1875 GB
SIZE: [1, 1024, 1024, 1024], in/out_dim: 2/1
8SC0: 1.8847475051879883, REAL_BD: 3.0313431534440896 GB/s, TOTAL_BD: 2.3212658395659367 GB/s, comm_vol: 4.375 GB
8SC1: 1.4303524494171143, REAL_BD: 4.187320844966768 GB/s, TOTAL_BD: 3.0586866906704464 GB/s, comm_vol: 4.375 GB
SIZE: [1, 1024, 1024, 2048], in/out_dim: 2/1
8SC0: 3.3195154666900635, REAL_BD: 3.141270980256473 GB/s, TOTAL_BD: 2.6359268657738024 GB/s, comm_vol: 8.75 GB
8SC1: 2.6239373683929443, REAL_BD: 4.208436528563749 GB/s, TOTAL_BD: 3.334683253266453 GB/s, comm_vol: 8.75 GB
SIZE: [1, 1024, 1024, 4096], in/out_dim: 2/1
8SC0: 6.399932622909546, REAL_BD: 3.1499604779001076 GB/s, TOTAL_BD: 2.7344037869017637 GB/s, comm_vol: 17.5 GB
8SC1: 5.018581867218018, REAL_BD: 4.214529884392185 GB/s, TOTAL_BD: 3.4870408539735323 GB/s, comm_vol: 17.5 GB

CONFIG:
WORLD_SIZE: 8

round 0:
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
SC0: 0.4525015354156494, REAL_BD: 2.593373555772717 GB/s, TOTAL_BD: 0.6042797175236797 GB/s, comm_vol: 0.2734375 GB
A2A: 0.1921236515045166, REAL_BD: 3.954980836079849 GB/s, TOTAL_BD: 1.423237055191884 GB/s, comm_vol: 0.2734375 GB
Traceback (most recent call last):
  File "all2all_test.py", line 109, in <module>
    main()
  File "all2all_test.py", line 101, in main
    torch.multiprocessing.spawn(comm_test, nprocs=args.gpus, args=(args.gpus, SIZE, 2, 1, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/all2all_test.py", line 68, in comm_test
    b, bandwidth = _all_to_all(a, in_dim, out_dim, method=method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 469, in _all_to_all
    output_p2p, bandwidth = _all_to_all_p2p(tensor, in_dim, out_dim, method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 448, in _all_to_all_p2p
    assert False, 'Wrong method !!!'
AssertionError: Wrong method !!!

srun: error: nico3: task 0: Exited with exit code 1
CONFIG:
WORLD_SIZE: 8

round 0:
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
SC0: 0.3965730667114258, REAL_BD: 2.636592656944253 GB/s, TOTAL_BD: 0.6895009342602991 GB/s, comm_vol: 0.2734375 GB
A2A: 0.18893790245056152, REAL_BD: 3.960155947690417 GB/s, TOTAL_BD: 1.4472347604872404 GB/s, comm_vol: 0.2734375 GB
SC1: 0.1813364028930664, REAL_BD: 3.834911645842106 GB/s, TOTAL_BD: 1.5079018643666675 GB/s, comm_vol: 0.2734375 GB
AGD: 0.9391014575958252, REAL_BD: 2.7003722747685 GB/s, TOTAL_BD: 0.291169285052567 GB/s, comm_vol: 0.2734375 GB
SIZE: [1, 1024, 1024, 128], in/out_dim: 2/1
SC0: 0.5576512813568115, REAL_BD: 2.7722254839637914 GB/s, TOTAL_BD: 0.980675591149738 GB/s, comm_vol: 0.546875 GB
A2A: 0.2957642078399658, REAL_BD: 4.079299097377517 GB/s, TOTAL_BD: 1.8490235988795067 GB/s, comm_vol: 0.546875 GB
SC1: 0.296161413192749, REAL_BD: 4.025202815719281 GB/s, TOTAL_BD: 1.8465437279774206 GB/s, comm_vol: 0.546875 GB
AGD: 1.7751367092132568, REAL_BD: 2.7316622873578664 GB/s, TOTAL_BD: 0.3080748638466137 GB/s, comm_vol: 0.546875 GB
SIZE: [1, 1024, 1024, 256], in/out_dim: 2/1
SC0: 0.7716708183288574, REAL_BD: 2.8633985115927807 GB/s, TOTAL_BD: 1.4173789833968873 GB/s, comm_vol: 1.09375 GB
A2A: 0.5309195518493652, REAL_BD: 4.146844815341004 GB/s, TOTAL_BD: 2.060104955995901 GB/s, comm_vol: 1.09375 GB
SC1: 0.536700963973999, REAL_BD: 4.1208574726216725 GB/s, TOTAL_BD: 2.0379132392484163 GB/s, comm_vol: 1.09375 GB
AGD: 3.4641098976135254, REAL_BD: 2.7652751497941006 GB/s, TOTAL_BD: 0.31573767355172533 GB/s, comm_vol: 1.09375 GB
SIZE: [1, 1024, 1024, 512], in/out_dim: 2/1
SC0: 1.1420345306396484, REAL_BD: 2.9317053546782157 GB/s, TOTAL_BD: 1.9154412071715476 GB/s, comm_vol: 2.1875 GB
A2A: 0.8373439311981201, REAL_BD: 4.16814977076635 GB/s, TOTAL_BD: 2.612427126413872 GB/s, comm_vol: 2.1875 GB
SC1: 0.8393921852111816, REAL_BD: 4.159775425800483 GB/s, TOTAL_BD: 2.606052377589922 GB/s, comm_vol: 2.1875 GB
AGD: 6.858273267745972, REAL_BD: 2.7776650366186924 GB/s, TOTAL_BD: 0.3189578359742058 GB/s, comm_vol: 2.1875 GB
SIZE: [1, 1024, 1024, 1024], in/out_dim: 2/1
SC0: 1.8639390468597412, REAL_BD: 3.0418098156877234 GB/s, TOTAL_BD: 2.3471797574983753 GB/s, comm_vol: 4.375 GB
A2A: 1.4336764812469482, REAL_BD: 4.204199540704155 GB/s, TOTAL_BD: 3.0515950127010654 GB/s, comm_vol: 4.375 GB
SC1: 1.4620935916900635, REAL_BD: 4.185728219563928 GB/s, TOTAL_BD: 2.992284505496566 GB/s, comm_vol: 4.375 GB
AGD: 15.924708843231201, REAL_BD: 2.701243573754257 GB/s, TOTAL_BD: 0.2747302976191991 GB/s, comm_vol: 4.375 GB
SIZE: [1, 1024, 1024, 2048], in/out_dim: 2/1
SC0: 3.340423345565796, REAL_BD: 3.1379081796141057 GB/s, TOTAL_BD: 2.6194284660401146 GB/s, comm_vol: 8.75 GB
A2A: 2.6027421951293945, REAL_BD: 4.268949270056549 GB/s, TOTAL_BD: 3.3618389160379354 GB/s, comm_vol: 8.75 GB
SC1: 2.6015450954437256, REAL_BD: 4.261993911476801 GB/s, TOTAL_BD: 3.3633858645481522 GB/s, comm_vol: 8.75 GB
Traceback (most recent call last):
  File "all2all_test.py", line 109, in <module>
    main()
  File "all2all_test.py", line 101, in main
    torch.multiprocessing.spawn(comm_test, nprocs=args.gpus, args=(args.gpus, SIZE, 2, 1, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/all2all_test.py", line 68, in comm_test
    b, bandwidth = _all_to_all(a, in_dim, out_dim, method=method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 466, in _all_to_all
    output_ag, bandwidth = _all_to_all_allgather_del(tensor, in_dim, out_dim, method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 168, in _all_to_all_allgather_del
    gathered, bandwidth = _gather(tensor.contiguous(), dim=out_dim, method=method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 139, in _gather
    dist.all_gather(list(tensor_list),
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 2068, in all_gather
    work = default_pg.allgather([tensor_list], [tensor])
RuntimeError: CUDA out of memory. Tried to allocate 8.00 GiB (GPU 0; 15.77 GiB total capacity; 10.00 GiB already allocated; 5.03 GiB free; 10.00 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

srun: error: nico3: task 0: Exited with exit code 1
CONFIG:
WORLD_SIZE: 4

round 0:
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
A2A: 0.2577698230743408, REAL_BD: 3.564754414474814 GB/s, TOTAL_BD: 1.8184828402695241 GB/s, comm_vol: 0.46875 GB
AGD: 0.7617783546447754, REAL_BD: 2.747375106402107 GB/s, TOTAL_BD: 0.6153364651829503 GB/s, comm_vol: 0.46875 GB
SC0: 0.1768627166748047, REAL_BD: 2.9844980943257964 GB/s, TOTAL_BD: 2.6503607363551067 GB/s, comm_vol: 0.46875 GB
SC1: 0.1406261920928955, REAL_BD: 3.834029872598291 GB/s, TOTAL_BD: 3.3333050765560865 GB/s, comm_vol: 0.46875 GB
SC2: 0.1316378116607666, REAL_BD: 4.087309429696407 GB/s, TOTAL_BD: 3.5609069619599767 GB/s, comm_vol: 0.46875 GB
SC3: 0.1596846580505371, REAL_BD: 3.2984421337420713 GB/s, TOTAL_BD: 2.9354729860876785 GB/s, comm_vol: 0.46875 GB
SIZE: [1, 1024, 1024, 128], in/out_dim: 2/1
A2A: 0.40823888778686523, REAL_BD: 3.6748861081269766 GB/s, TOTAL_BD: 2.2964495251355213 GB/s, comm_vol: 0.9375 GB
AGD: 1.504767656326294, REAL_BD: 2.737263867908019 GB/s, TOTAL_BD: 0.6230197705663022 GB/s, comm_vol: 0.9375 GB
SC0: 0.32787084579467773, REAL_BD: 3.0481876989127725 GB/s, TOTAL_BD: 2.859357616038511 GB/s, comm_vol: 0.9375 GB
SC1: 0.3628561496734619, REAL_BD: 3.9035731834122265 GB/s, TOTAL_BD: 2.5836684891345127 GB/s, comm_vol: 0.9375 GB
SC2: 0.2443714141845703, REAL_BD: 4.150158619282115 GB/s, TOTAL_BD: 3.8363734282436135 GB/s, comm_vol: 0.9375 GB
SC3: 0.30045509338378906, REAL_BD: 3.335072716212381 GB/s, TOTAL_BD: 3.120266624345342 GB/s, comm_vol: 0.9375 GB
SIZE: [1, 1024, 1024, 256], in/out_dim: 2/1
A2A: 0.6322987079620361, REAL_BD: 3.794270112978327 GB/s, TOTAL_BD: 2.9653706015679173 GB/s, comm_vol: 1.875 GB
AGD: 2.939835786819458, REAL_BD: 2.806410255795302 GB/s, TOTAL_BD: 0.637790725729113 GB/s, comm_vol: 1.875 GB
SC0: 0.6380414962768555, REAL_BD: 3.0940767359559516 GB/s, TOTAL_BD: 2.9386803380989037 GB/s, comm_vol: 1.875 GB
SC1: 0.5012030601501465, REAL_BD: 3.955687969188214 GB/s, TOTAL_BD: 3.740998707067555 GB/s, comm_vol: 1.875 GB
SC2: 0.47171950340270996, REAL_BD: 4.19982909285938 GB/s, TOTAL_BD: 3.9748197529990623 GB/s, comm_vol: 1.875 GB
SC3: 0.5782365798950195, REAL_BD: 3.374189818933742 GB/s, TOTAL_BD: 3.242617408155692 GB/s, comm_vol: 1.875 GB
SIZE: [1, 1024, 1024, 512], in/out_dim: 2/1
A2A: 1.1383347511291504, REAL_BD: 3.8727637692376446 GB/s, TOTAL_BD: 3.294285794473248 GB/s, comm_vol: 3.75 GB
AGD: 5.631153106689453, REAL_BD: 2.8184202359962987 GB/s, TOTAL_BD: 0.6659382064297342 GB/s, comm_vol: 3.75 GB
SC0: 1.2530624866485596, REAL_BD: 3.0953077087681846 GB/s, TOTAL_BD: 2.9926679953764705 GB/s, comm_vol: 3.75 GB
SC1: 0.9762051105499268, REAL_BD: 3.9707352288534183 GB/s, TOTAL_BD: 3.841405826985999 GB/s, comm_vol: 3.75 GB
SC2: 0.9207706451416016, REAL_BD: 4.206269294632697 GB/s, TOTAL_BD: 4.072675448317863 GB/s, comm_vol: 3.75 GB
SC3: 1.1412506103515625, REAL_BD: 3.3757662213409296 GB/s, TOTAL_BD: 3.2858689984356824 GB/s, comm_vol: 3.75 GB
SIZE: [1, 1024, 1024, 1024], in/out_dim: 2/1
A2A: 2.236844778060913, REAL_BD: 3.8459368189835876 GB/s, TOTAL_BD: 3.352937170053273 GB/s, comm_vol: 7.5 GB
AGD: 14.226509094238281, REAL_BD: 2.7277873759866855 GB/s, TOTAL_BD: 0.5271848455808101 GB/s, comm_vol: 7.5 GB
SC0: 2.46454119682312, REAL_BD: 3.121415397714967 GB/s, TOTAL_BD: 3.0431627637905843 GB/s, comm_vol: 7.5 GB
SC1: 1.9251189231872559, REAL_BD: 3.9939283902200566 GB/s, TOTAL_BD: 3.8958632163788027 GB/s, comm_vol: 7.5 GB
SC2: 1.8140482902526855, REAL_BD: 4.2358787911889415 GB/s, TOTAL_BD: 4.134399310260532 GB/s, comm_vol: 7.5 GB
SC3: 2.2526535987854004, REAL_BD: 3.3919790680476205 GB/s, TOTAL_BD: 3.3294067068473803 GB/s, comm_vol: 7.5 GB
SIZE: [1, 1024, 1024, 2048], in/out_dim: 2/1
A2A: 4.1639320850372314, REAL_BD: 3.982746348756799 GB/s, TOTAL_BD: 3.6023642301711267 GB/s, comm_vol: 15.0 GB
Traceback (most recent call last):
  File "all2all_test.py", line 109, in <module>
    main()
  File "all2all_test.py", line 101, in main
    torch.multiprocessing.spawn(comm_test, nprocs=args.gpus, args=(args.gpus, SIZE, 2, 1, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 2 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/all2all_test.py", line 68, in comm_test
    b, bandwidth = _all_to_all(a, in_dim, out_dim, method=method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 466, in _all_to_all
    output_ag, bandwidth = _all_to_all_allgather_del(tensor, in_dim, out_dim, method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 168, in _all_to_all_allgather_del
    gathered, bandwidth = _gather(tensor.contiguous(), dim=out_dim, method=method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 139, in _gather
    dist.all_gather(list(tensor_list),
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 2068, in all_gather
    work = default_pg.allgather([tensor_list], [tensor])
RuntimeError: CUDA out of memory. Tried to allocate 8.00 GiB (GPU 2; 15.77 GiB total capacity; 12.00 GiB already allocated; 3.03 GiB free; 12.00 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

srun: error: nico3: task 0: Exited with exit code 1
CONFIG:
WORLD_SIZE: 4

round 0:
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
SC0: 0.3233456611633301, REAL_BD: 2.776435847771089 GB/s, TOTAL_BD: 1.449686995376822 GB/s, comm_vol: 0.46875 GB
SC1: 0.21721243858337402, REAL_BD: 3.8308973885683906 GB/s, TOTAL_BD: 2.1580255857220476 GB/s, comm_vol: 0.46875 GB
SC2: 0.20352435111999512, REAL_BD: 4.072298359795695 GB/s, TOTAL_BD: 2.303164203302786 GB/s, comm_vol: 0.46875 GB
SC3: 0.2322099208831787, REAL_BD: 3.284198126289484 GB/s, TOTAL_BD: 2.018647602209128 GB/s, comm_vol: 0.46875 GB
A2A: 0.20613908767700195, REAL_BD: 3.8705628258529075 GB/s, TOTAL_BD: 2.2739501046714703 GB/s, comm_vol: 0.46875 GB
AGD: 0.746396541595459, REAL_BD: 2.753855908418296 GB/s, TOTAL_BD: 0.6280173793383662 GB/s, comm_vol: 0.46875 GB
SIZE: [1, 1024, 1024, 128], in/out_dim: 2/1
SC0: 0.43405890464782715, REAL_BD: 2.9065812469329657 GB/s, TOTAL_BD: 2.1598451038820152 GB/s, comm_vol: 0.9375 GB
SC1: 0.3384435176849365, REAL_BD: 3.9035045706292246 GB/s, TOTAL_BD: 2.7700338491125613 GB/s, comm_vol: 0.9375 GB
SC2: 0.3399052619934082, REAL_BD: 4.149394074067669 GB/s, TOTAL_BD: 2.7581214674404806 GB/s, comm_vol: 0.9375 GB
SC3: 0.3829519748687744, REAL_BD: 3.3437981870903903 GB/s, TOTAL_BD: 2.4480876494271944 GB/s, comm_vol: 0.9375 GB
A2A: 0.3381376266479492, REAL_BD: 3.93350079356033 GB/s, TOTAL_BD: 2.772539717906268 GB/s, comm_vol: 0.9375 GB
AGD: 1.4502253532409668, REAL_BD: 2.782040740049502 GB/s, TOTAL_BD: 0.6464512552513807 GB/s, comm_vol: 0.9375 GB
SIZE: [1, 1024, 1024, 256], in/out_dim: 2/1
SC0: 0.7392330169677734, REAL_BD: 3.0358721016340353 GB/s, TOTAL_BD: 2.5364126830954845 GB/s, comm_vol: 1.875 GB
SC1: 0.5977563858032227, REAL_BD: 3.9350385678883804 GB/s, TOTAL_BD: 3.136729350838315 GB/s, comm_vol: 1.875 GB
SC2: 0.5713725090026855, REAL_BD: 4.182964239028587 GB/s, TOTAL_BD: 3.281571952547663 GB/s, comm_vol: 1.875 GB
SC3: 0.6718389987945557, REAL_BD: 3.3639353583088116 GB/s, TOTAL_BD: 2.7908472169138903 GB/s, comm_vol: 1.875 GB
A2A: 0.5973935127258301, REAL_BD: 3.9673503687822937 GB/s, TOTAL_BD: 3.13863468561052 GB/s, comm_vol: 1.875 GB
AGD: 2.8381426334381104, REAL_BD: 2.811747023694142 GB/s, TOTAL_BD: 0.6606433298698012 GB/s, comm_vol: 1.875 GB
SIZE: [1, 1024, 1024, 512], in/out_dim: 2/1
SC0: 1.37624192237854, REAL_BD: 3.0932366050085394 GB/s, TOTAL_BD: 2.724811633058617 GB/s, comm_vol: 3.75 GB
SC1: 1.1079676151275635, REAL_BD: 3.9694297418251585 GB/s, TOTAL_BD: 3.3845754594264488 GB/s, comm_vol: 3.75 GB
SC2: 1.0487754344940186, REAL_BD: 4.202699489072136 GB/s, TOTAL_BD: 3.575598623559663 GB/s, comm_vol: 3.75 GB
SC3: 1.280735731124878, REAL_BD: 3.3693221099978174 GB/s, TOTAL_BD: 2.928004512458126 GB/s, comm_vol: 3.75 GB
A2A: 1.097599983215332, REAL_BD: 3.991982083264591 GB/s, TOTAL_BD: 3.4165452417507085 GB/s, comm_vol: 3.75 GB
AGD: 5.6157066822052, REAL_BD: 2.8215962859515518 GB/s, TOTAL_BD: 0.6677699196581673 GB/s, comm_vol: 3.75 GB
SIZE: [1, 1024, 1024, 1024], in/out_dim: 2/1
SC0: 2.643172025680542, REAL_BD: 3.1056359059489544 GB/s, TOTAL_BD: 2.8374997643480895 GB/s, comm_vol: 7.5 GB
SC1: 2.1144888401031494, REAL_BD: 3.9881778841833984 GB/s, TOTAL_BD: 3.5469565304653647 GB/s, comm_vol: 7.5 GB
SC2: 2.024479866027832, REAL_BD: 4.212089938896304 GB/s, TOTAL_BD: 3.704655267683898 GB/s, comm_vol: 7.5 GB
SC3: 2.4613873958587646, REAL_BD: 3.3722051201726706 GB/s, TOTAL_BD: 3.047061999512389 GB/s, comm_vol: 7.5 GB
A2A: 2.112640619277954, REAL_BD: 4.006561388875868 GB/s, TOTAL_BD: 3.550059547072093 GB/s, comm_vol: 7.5 GB
AGD: 14.195844173431396, REAL_BD: 2.700954158816759 GB/s, TOTAL_BD: 0.5283236353098902 GB/s, comm_vol: 7.5 GB
SIZE: [1, 1024, 1024, 2048], in/out_dim: 2/1
SC0: 5.19005560874939, REAL_BD: 3.115334064575238 GB/s, TOTAL_BD: 2.890142443698102 GB/s, comm_vol: 15.0 GB
SC1: 4.152737617492676, REAL_BD: 3.995500649862545 GB/s, TOTAL_BD: 3.612075065088423 GB/s, comm_vol: 15.0 GB
SC2: 3.9644603729248047, REAL_BD: 4.213209696548375 GB/s, TOTAL_BD: 3.783617085049499 GB/s, comm_vol: 15.0 GB
SC3: 4.840277671813965, REAL_BD: 3.3757146361822605 GB/s, TOTAL_BD: 3.098995763682816 GB/s, comm_vol: 15.0 GB
A2A: 4.147690534591675, REAL_BD: 4.010400719630203 GB/s, TOTAL_BD: 3.616470388738078 GB/s, comm_vol: 15.0 GB
Traceback (most recent call last):
  File "all2all_test.py", line 109, in <module>
    main()
  File "all2all_test.py", line 101, in main
    torch.multiprocessing.spawn(comm_test, nprocs=args.gpus, args=(args.gpus, SIZE, 2, 1, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 3 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/all2all_test.py", line 68, in comm_test
    b, bandwidth = _all_to_all(a, in_dim, out_dim, method=method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 466, in _all_to_all
    output_ag, bandwidth = _all_to_all_allgather_del(tensor, in_dim, out_dim, method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 168, in _all_to_all_allgather_del
    gathered, bandwidth = _gather(tensor.contiguous(), dim=out_dim, method=method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 139, in _gather
    dist.all_gather(list(tensor_list),
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 2068, in all_gather
    work = default_pg.allgather([tensor_list], [tensor])
RuntimeError: CUDA out of memory. Tried to allocate 8.00 GiB (GPU 3; 15.77 GiB total capacity; 12.00 GiB already allocated; 3.03 GiB free; 12.00 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

srun: error: nico3: task 0: Exited with exit code 1
CONFIG:
WORLD_SIZE: 4

round 0:
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
SC0: 0.3131697177886963, REAL_BD: 2.793049983393564 GB/s, TOTAL_BD: 1.4967922291780387 GB/s, comm_vol: 0.46875 GB
SC1: 0.2093067169189453, REAL_BD: 3.8151035784163256 GB/s, TOTAL_BD: 2.239536345990869 GB/s, comm_vol: 0.46875 GB
SC2: 0.20046257972717285, REAL_BD: 4.088286248105028 GB/s, TOTAL_BD: 2.338341652781098 GB/s, comm_vol: 0.46875 GB
SC3: 0.22726082801818848, REAL_BD: 3.298178195665534 GB/s, TOTAL_BD: 2.0626079913890143 GB/s, comm_vol: 0.46875 GB
A2A: 0.20198345184326172, REAL_BD: 3.8704944606292457 GB/s, TOTAL_BD: 2.3207346726787694 GB/s, comm_vol: 0.46875 GB
AGD: 0.7546877861022949, REAL_BD: 2.7531390407255807 GB/s, TOTAL_BD: 0.621117776956394 GB/s, comm_vol: 0.46875 GB
SIZE: [1, 1024, 1024, 128], in/out_dim: 2/1
SC0: 0.47146058082580566, REAL_BD: 2.8728977002159732 GB/s, TOTAL_BD: 1.9885013469373927 GB/s, comm_vol: 0.9375 GB
SC1: 0.34453630447387695, REAL_BD: 3.9008082502363797 GB/s, TOTAL_BD: 2.7210485160093834 GB/s, comm_vol: 0.9375 GB
SC2: 0.3327765464782715, REAL_BD: 4.1479077370473485 GB/s, TOTAL_BD: 2.8172057493877913 GB/s, comm_vol: 0.9375 GB
SC3: 0.38210511207580566, REAL_BD: 3.3377539277823067 GB/s, TOTAL_BD: 2.4535133667984264 GB/s, comm_vol: 0.9375 GB
A2A: 0.3342256546020508, REAL_BD: 3.930668672605176 GB/s, TOTAL_BD: 2.804991140240997 GB/s, comm_vol: 0.9375 GB
AGD: 1.4461758136749268, REAL_BD: 2.7958460718476923 GB/s, TOTAL_BD: 0.6482614293055329 GB/s, comm_vol: 0.9375 GB
SIZE: [1, 1024, 1024, 256], in/out_dim: 2/1
SC0: 0.7473418712615967, REAL_BD: 3.0320620882333458 GB/s, TOTAL_BD: 2.5088919437028068 GB/s, comm_vol: 1.875 GB
SC1: 0.5990891456604004, REAL_BD: 3.9484858287475904 GB/s, TOTAL_BD: 3.1297512458402346 GB/s, comm_vol: 1.875 GB
SC2: 0.5708296298980713, REAL_BD: 4.166150348553044 GB/s, TOTAL_BD: 3.2846928431777527 GB/s, comm_vol: 1.875 GB
SC3: 0.675123929977417, REAL_BD: 3.3621171486620995 GB/s, TOTAL_BD: 2.7772678714894896 GB/s, comm_vol: 1.875 GB
A2A: 0.5915775299072266, REAL_BD: 3.9749947903612153 GB/s, TOTAL_BD: 3.1694915800707384 GB/s, comm_vol: 1.875 GB
AGD: 2.8435263633728027, REAL_BD: 2.811803359601112 GB/s, TOTAL_BD: 0.6593925149250239 GB/s, comm_vol: 1.875 GB
SIZE: [1, 1024, 1024, 512], in/out_dim: 2/1
SC0: 1.3755378723144531, REAL_BD: 3.098221415767015 GB/s, TOTAL_BD: 2.7262062902639848 GB/s, comm_vol: 3.75 GB
SC1: 1.1090164184570312, REAL_BD: 3.9726034181435232 GB/s, TOTAL_BD: 3.381374646569575 GB/s, comm_vol: 3.75 GB
SC2: 1.0521235466003418, REAL_BD: 4.2020366146838715 GB/s, TOTAL_BD: 3.5642202021969096 GB/s, comm_vol: 3.75 GB
SC3: 1.2793395519256592, REAL_BD: 3.368817420210891 GB/s, TOTAL_BD: 2.931199926052085 GB/s, comm_vol: 3.75 GB
A2A: 1.1050949096679688, REAL_BD: 3.9910038571874393 GB/s, TOTAL_BD: 3.3933736977638476 GB/s, comm_vol: 3.75 GB
AGD: 5.6499481201171875, REAL_BD: 2.8115921654892624 GB/s, TOTAL_BD: 0.6637229086489771 GB/s, comm_vol: 3.75 GB
SIZE: [1, 1024, 1024, 1024], in/out_dim: 2/1
SC0: 2.7566850185394287, REAL_BD: 3.094891371387099 GB/s, TOTAL_BD: 2.7206590341517205 GB/s, comm_vol: 7.5 GB
SC1: 2.13912034034729, REAL_BD: 3.9859198955247463 GB/s, TOTAL_BD: 3.50611410612942 GB/s, comm_vol: 7.5 GB
SC2: 2.030789375305176, REAL_BD: 4.2102483372332715 GB/s, TOTAL_BD: 3.6931451834452016 GB/s, comm_vol: 7.5 GB
SC3: 2.4713637828826904, REAL_BD: 3.371572657288195 GB/s, TOTAL_BD: 3.0347616372575152 GB/s, comm_vol: 7.5 GB
A2A: 2.112396478652954, REAL_BD: 4.009246142311835 GB/s, TOTAL_BD: 3.5504698458798067 GB/s, comm_vol: 7.5 GB
AGD: 11.19757866859436, REAL_BD: 2.8261801760719925 GB/s, TOTAL_BD: 0.6697876587404659 GB/s, comm_vol: 7.5 GB
SIZE: [1, 1024, 1024, 2048], in/out_dim: 2/1
SC0: 5.203335762023926, REAL_BD: 3.116717509880523 GB/s, TOTAL_BD: 2.882766111208148 GB/s, comm_vol: 15.0 GB
SC1: 4.166524887084961, REAL_BD: 3.9985231613555157 GB/s, TOTAL_BD: 3.6001225017269722 GB/s, comm_vol: 15.0 GB
SC2: 3.9599273204803467, REAL_BD: 4.219167251627109 GB/s, TOTAL_BD: 3.78794830966253 GB/s, comm_vol: 15.0 GB
SC3: 4.838167667388916, REAL_BD: 3.38330688484519 GB/s, TOTAL_BD: 3.1003472866609574 GB/s, comm_vol: 15.0 GB
A2A: 4.1525490283966064, REAL_BD: 4.017704123795577 GB/s, TOTAL_BD: 3.6122391084186285 GB/s, comm_vol: 15.0 GB
AGD: 28.4885835647583, REAL_BD: 2.7699260626200837 GB/s, TOTAL_BD: 0.5265267037900647 GB/s, comm_vol: 15.0 GB
SIZE: [1, 1024, 1024, 4096], in/out_dim: 2/1
SC0: 10.292458772659302, REAL_BD: 3.1295015814226956 GB/s, TOTAL_BD: 2.9147554207058324 GB/s, comm_vol: 30.0 GB
SC1: 8.228033542633057, REAL_BD: 4.009009036546077 GB/s, TOTAL_BD: 3.646071670048113 GB/s, comm_vol: 30.0 GB
SC2: 7.854014158248901, REAL_BD: 4.2270769378213116 GB/s, TOTAL_BD: 3.819702816360682 GB/s, comm_vol: 30.0 GB
SC3: 9.624237060546875, REAL_BD: 3.3821903736490015 GB/s, TOTAL_BD: 3.1171302006868187 GB/s, comm_vol: 30.0 GB
A2A: 8.235055446624756, REAL_BD: 4.024075457585772 GB/s, TOTAL_BD: 3.642962721313053 GB/s, comm_vol: 30.0 GB
Traceback (most recent call last):
  File "all2all_test.py", line 109, in <module>
    main()
  File "all2all_test.py", line 101, in main
    torch.multiprocessing.spawn(comm_test, nprocs=args.gpus, args=(args.gpus, SIZE, 2, 1, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 3 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/all2all_test.py", line 68, in comm_test
    b, bandwidth = _all_to_all(a, in_dim, out_dim, method=method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 466, in _all_to_all
    output_ag, bandwidth = _all_to_all_allgather_del(tensor, in_dim, out_dim, method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 168, in _all_to_all_allgather_del
    gathered, bandwidth = _gather(tensor.contiguous(), dim=out_dim, method=method)
  File "/home/yhy/fold/comm_test/utils/comm.py", line 139, in _gather
    dist.all_gather(list(tensor_list),
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 2068, in all_gather
    work = default_pg.allgather([tensor_list], [tensor])
RuntimeError: CUDA out of memory. Tried to allocate 16.00 GiB (GPU 3; 31.74 GiB total capacity; 24.00 GiB already allocated; 7.00 GiB free; 24.00 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

srun: error: nico3: task 0: Exited with exit code 1
./scripts/all2all_test.sh: line 6: hon: command not found
GPU_NUM: 4
CUDA_VISIBLE_DEVICES: 4,5,6,7
CONFIG:
WORLD_SIZE: 4

round 0:
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
SC0: 0.2942519187927246, REAL_BD: 2.7982634293396744 GB/s, TOTAL_BD: 1.593022747050273 GB/s, comm_vol: 0.46875 GB
SC1: 0.23007822036743164, REAL_BD: 3.841034715190498 GB/s, TOTAL_BD: 2.0373505986416833 GB/s, comm_vol: 0.46875 GB
SC2: 0.19907093048095703, REAL_BD: 4.081060547578759 GB/s, TOTAL_BD: 2.354688345844851 GB/s, comm_vol: 0.46875 GB
SC3: 0.23248863220214844, REAL_BD: 3.3003794537782674 GB/s, TOTAL_BD: 2.016227613195396 GB/s, comm_vol: 0.46875 GB
A2A: 0.21664738655090332, REAL_BD: 3.884538519463505 GB/s, TOTAL_BD: 2.1636540715429438 GB/s, comm_vol: 0.46875 GB
AGD: 0.7538025379180908, REAL_BD: 2.73851837625802 GB/s, TOTAL_BD: 0.6218472032405588 GB/s, comm_vol: 0.46875 GB
SIZE: [1, 1024, 1024, 128], in/out_dim: 2/1
SC0: 0.4306831359863281, REAL_BD: 2.9248351065097036 GB/s, TOTAL_BD: 2.176774342122745 GB/s, comm_vol: 0.9375 GB
SC1: 0.3289968967437744, REAL_BD: 3.8983622143801697 GB/s, TOTAL_BD: 2.8495709512121414 GB/s, comm_vol: 0.9375 GB
SC2: 0.31755685806274414, REAL_BD: 4.155617198195828 GB/s, TOTAL_BD: 2.9522272191481536 GB/s, comm_vol: 0.9375 GB
SC3: 0.3723742961883545, REAL_BD: 3.340943660767119 GB/s, TOTAL_BD: 2.517628122016761 GB/s, comm_vol: 0.9375 GB
A2A: 0.3321988582611084, REAL_BD: 3.933381047581963 GB/s, TOTAL_BD: 2.822104822717737 GB/s, comm_vol: 0.9375 GB
AGD: 1.4396307468414307, REAL_BD: 2.791847438284984 GB/s, TOTAL_BD: 0.6512086533695447 GB/s, comm_vol: 0.9375 GB
GPU_NUM: 8
CUDA_VISIBLE_DEVICES: 
CONFIG:
WORLD_SIZE: 8

round 0:
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
A2A: 0.3590822219848633, REAL_BD: 3.5228007293711237 GB/s, TOTAL_BD: 0.7614899409069783 GB/s, comm_vol: 0.2734375 GB
SIZE: [1, 1024, 1024, 128], in/out_dim: 2/1
A2A: 0.4992382526397705, REAL_BD: 3.7096964088296267 GB/s, TOTAL_BD: 1.0954188648573013 GB/s, comm_vol: 0.546875 GB
SIZE: [1, 1024, 1024, 256], in/out_dim: 2/1
A2A: 0.6871984004974365, REAL_BD: 3.7802392242036205 GB/s, TOTAL_BD: 1.5916073134167315 GB/s, comm_vol: 1.09375 GB
SIZE: [1, 1024, 1024, 512], in/out_dim: 2/1
A2A: 0.9770157337188721, REAL_BD: 3.854766576055174 GB/s, TOTAL_BD: 2.2389608728956607 GB/s, comm_vol: 2.1875 GB
SIZE: [1, 1024, 1024, 1024], in/out_dim: 2/1
A2A: 1.5813369750976562, REAL_BD: 3.938293698219872 GB/s, TOTAL_BD: 2.7666462423227784 GB/s, comm_vol: 4.375 GB
SIZE: [1, 1024, 1024, 2048], in/out_dim: 2/1
A2A: 2.758680582046509, REAL_BD: 4.032692345516904 GB/s, TOTAL_BD: 3.1718061369427812 GB/s, comm_vol: 8.75 GB
SIZE: [1, 1024, 1024, 4096], in/out_dim: 2/1
A2A: 5.1357715129852295, REAL_BD: 4.107273043646542 GB/s, TOTAL_BD: 3.407472461684323 GB/s, comm_vol: 17.5 GB

GPU_NUM: 8
CUDA_VISIBLE_DEVICES: 
CONFIG:
WORLD_SIZE: 8

round 0:
GPU_NUM: 8
CUDA_VISIBLE_DEVICES: 
CONFIG:
WORLD_SIZE: 8

round 0:
rank 0: 0, 4
rank 0: 0, 4
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
rank 0: 0, 4
rank 0: 0, 4
rank 0: 0, 4
rank 0: 0, 4
rank 0: 0, 4
rank 0: 0, 4
rank 0: round1 done !!!
rank 0: 4, 8
rank 0: round1 done !!!
rank 0: 4, 8
rank 0: round1 done !!!
rank 0: 4, 8
rank 0: round1 done !!!
rank 0: 4, 8
rank 0: round1 done !!!
rank 0: 4, 8
rank 0: round2 done !!!
rank 0: round2 done !!!
rank 0: round1 done !!!
rank 0: round2 done !!!
rank 0: 4, 8
rank 0: round1 done !!!
rank 0: 4, 8
rank 0: round2 done !!!
rank 0: round2 done !!!
rank 0: round2 done !!!
rank 0: round2 done !!!
GPU_NUM: 8
CUDA_VISIBLE_DEVICES: 
CONFIG:
WORLD_SIZE: 8

round 0:
rank 2: 0, 4
rank 3: 0, 4
rank 4: 4, 8
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
rank 0: 0, 4
rank 6: 4, 8
rank 7: 4, 8
rank 1: 0, 4
rank 5: 4, 8
rank 1: round1 done !!!
rank 1: 4, 8
rank 3: round1 done !!!
rank 3: 4, 8
rank 5: round1 done !!!
rank 5: 0, 4
rank 7: round1 done !!!
rank 7: 0, 4
rank 0: round1 done !!!
rank 0: 4, 8
rank 2: round1 done !!!
rank 2: 4, 8
rank 4: round1 done !!!
rank 4: 0, 4
rank 6: round1 done !!!
rank 6: 0, 4
rank 2: round2 done !!!
rank 4: round2 done !!!
rank 1: round2 done !!!
rank 3: round2 done !!!
rank 5: round2 done !!!
rank 6: round2 done !!!
rank 7: round2 done !!!
rank 0: round2 done !!!
equal !!!
rank 0: 0, 4
equal !!!
rank 3: 0, 4
equal !!!
rank 2: 0, 4
equal !!!
rank 5: 4, 8
equal !!!
rank 1: 0, 4
equal !!!
rank 4: 4, 8
equal !!!
rank 7: 4, 8
equal !!!
rank 6: 4, 8
rank 3: round1 done !!!
rank 2: round1 done !!!
rank 5: round1 done !!!
rank 4: round1 done !!!
rank 1: round1 done !!!
rank 3: 4, 8
rank 0: round1 done !!!
rank 2: 4, 8
rank 6: round1 done !!!
rank 5: 0, 4
rank 1: 4, 8
rank 7: round1 done !!!
rank 4: 0, 4
rank 0: 4, 8
rank 6: 0, 4
rank 7: 0, 4
rank 3: round2 done !!!
rank 2: round2 done !!!
rank 4: round2 done !!!
rank 7: round2 done !!!
rank 1: round2 done !!!
rank 6: round2 done !!!
rank 5: round2 done !!!
rank 0: round2 done !!!
equal !!!
rank 0: 0, 4
equal !!!
rank 1: 0, 4
equal !!!
rank 2: 0, 4
equal !!!
rank 3: 0, 4
equal !!!
rank 4: 4, 8
equal !!!
rank 6: 4, 8
equal !!!
rank 5: 4, 8
equal !!!
rank 7: 4, 8
rank 3: round1 done !!!
rank 0: round1 done !!!
rank 7: round1 done !!!
rank 5: round1 done !!!
rank 2: round1 done !!!
rank 6: round1 done !!!
rank 4: round1 done !!!
rank 3: 4, 8
rank 0: 4, 8
rank 7: 0, 4
rank 5: 0, 4
rank 2: 4, 8
rank 6: 0, 4
rank 1: round1 done !!!
rank 4: 0, 4
rank 1: 4, 8
rank 2: round2 done !!!
rank 7: round2 done !!!
rank 3: round2 done !!!
rank 4: round2 done !!!
rank 6: round2 done !!!
rank 0: round2 done !!!
rank 5: round2 done !!!
rank 1: round2 done !!!
equal !!!
rank 0: 0, 4
equal !!!
rank 2: 0, 4
equal !!!
rank 4: 4, 8
equal !!!
rank 1: 0, 4
equal !!!
rank 6: 4, 8
equal !!!
rank 5: 4, 8
equal !!!
rank 7: 4, 8
equal !!!
rank 3: 0, 4
rank 2: round1 done !!!
rank 0: round1 done !!!
rank 7: round1 done !!!
rank 6: round1 done !!!
rank 4: round1 done !!!
rank 5: round1 done !!!
rank 2: 4, 8
rank 0: 4, 8
rank 7: 0, 4
rank 6: 0, 4
rank 4: 0, 4
rank 5: 0, 4
rank 1: round1 done !!!
rank 1: 4, 8
rank 3: round1 done !!!
rank 3: 4, 8
rank 2: round2 done !!!
rank 1: round2 done !!!
rank 6: round2 done !!!
rank 7: round2 done !!!
rank 5: round2 done !!!
rank 4: round2 done !!!
rank 0: round2 done !!!
rank 3: round2 done !!!
equal !!!
rank 0: 0, 4
equal !!!
rank 1: 0, 4
equal !!!
rank 2: 0, 4
equal !!!
rank 4: 4, 8
equal !!!
rank 3: 0, 4
equal !!!
rank 5: 4, 8
equal !!!
rank 7: 4, 8
equal !!!
rank 6: 4, 8
rank 0: round1 done !!!
rank 3: round1 done !!!
rank 1: round1 done !!!
rank 7: round1 done !!!
rank 2: round1 done !!!
rank 4: round1 done !!!
rank 0: 4, 8
rank 5: round1 done !!!
rank 3: 4, 8
rank 7: 0, 4
rank 1: 4, 8
rank 4: 0, 4
rank 2: 4, 8
rank 5: 0, 4
rank 6: round1 done !!!
rank 6: 0, 4
rank 2: round2 done !!!
rank 3: round2 done !!!
rank 4: round2 done !!!
rank 7: round2 done !!!
rank 0: round2 done !!!
rank 1: round2 done !!!
rank 6: round2 done !!!
rank 5: round2 done !!!
equal !!!
rank 0: 0, 4
equal !!!
rank 1: 0, 4
equal !!!
rank 3: 0, 4
equal !!!
rank 2: 0, 4
equal !!!
rank 6: 4, 8
equal !!!
rank 4: 4, 8
equal !!!
rank 7: 4, 8
equal !!!
rank 5: 4, 8
rank 3: round1 done !!!
rank 1: round1 done !!!
rank 2: round1 done !!!
rank 0: round1 done !!!
rank 6: round1 done !!!
rank 3: 4, 8
rank 1: 4, 8
rank 2: 4, 8
rank 7: round1 done !!!
rank 6: 0, 4
rank 0: 4, 8
rank 5: round1 done !!!
rank 7: 0, 4
rank 4: round1 done !!!
rank 5: 0, 4
rank 4: 0, 4
rank 1: round2 done !!!
rank 2: round2 done !!!
rank 3: round2 done !!!
rank 6: round2 done !!!
rank 4: round2 done !!!
rank 7: round2 done !!!
rank 5: round2 done !!!
rank 0: round2 done !!!
equal !!!
rank 0: 0, 4
equal !!!
rank 1: 0, 4
equal !!!
rank 3: 0, 4
equal !!!
rank 2: 0, 4
equal !!!
rank 4: 4, 8
equal !!!
rank 5: 4, 8
equal !!!
rank 6: 4, 8
equal !!!
rank 7: 4, 8
rank 1: round1 done !!!
rank 0: round1 done !!!
rank 1: 4, 8
rank 0: 4, 8
rank 6: round1 done !!!
rank 7: round1 done !!!
rank 5: round1 done !!!
rank 6: 0, 4
rank 7: 0, 4
rank 5: 0, 4
rank 3: round1 done !!!
rank 3: 4, 8
rank 4: round1 done !!!
rank 4: 0, 4
rank 7: round2 done !!!
rank 6: round2 done !!!
rank 3: round2 done !!!
rank 1: round2 done !!!
rank 4: round2 done !!!
rank 5: round2 done !!!
rank 2: round1 done !!!
rank 0: round2 done !!!
rank 2: 4, 8
rank 2: round2 done !!!
equal !!!
rank 1: 0, 4
equal !!!
rank 2: 0, 4
equal !!!
rank 3: 0, 4
equal !!!
rank 4: 4, 8
equal !!!
rank 6: 4, 8
equal !!!
rank 5: 4, 8
equal !!!
rank 0: 0, 4
equal !!!
rank 7: 4, 8
rank 2: round1 done !!!
rank 2: 4, 8
rank 4: round1 done !!!
rank 3: round1 done !!!
rank 4: 0, 4
rank 3: 4, 8
rank 0: round1 done !!!
rank 0: 4, 8
rank 6: round1 done !!!
rank 1: round1 done !!!
rank 5: round1 done !!!
rank 6: 0, 4
rank 1: 4, 8
rank 5: 0, 4
rank 7: round1 done !!!
rank 7: 0, 4
rank 4: round2 done !!!
rank 2: round2 done !!!
rank 3: round2 done !!!
rank 5: round2 done !!!
rank 6: round2 done !!!
rank 1: round2 done !!!
rank 0: round2 done !!!
rank 7: round2 done !!!
equal !!!
rank 0: 0, 4
equal !!!
rank 1: 0, 4
equal !!!
rank 2: 0, 4
equal !!!
rank 3: 0, 4
equal !!!
rank 4: 4, 8
equal !!!
rank 5: 4, 8
equal !!!
rank 6: 4, 8
equal !!!
rank 7: 4, 8
rank 3: round1 done !!!
rank 2: round1 done !!!
rank 1: round1 done !!!
rank 4: round1 done !!!
rank 7: round1 done !!!
rank 6: round1 done !!!
rank 5: round1 done !!!
rank 3: 4, 8
rank 2: 4, 8
rank 1: 4, 8
rank 4: 0, 4
rank 7: 0, 4
rank 6: 0, 4
rank 5: 0, 4
rank 0: round1 done !!!
rank 0: 4, 8
rank 7: round2 done !!!
rank 6: round2 done !!!
rank 5: round2 done !!!
rank 3: round2 done !!!
rank 2: round2 done !!!
rank 4: round2 done !!!
rank 0: round2 done !!!
rank 1: round2 done !!!
equal !!!
rank 1: 0, 4
equal !!!
rank 0: 0, 4
equal !!!
rank 2: 0, 4
equal !!!
rank 4: 4, 8
equal !!!
rank 5: 4, 8
equal !!!
rank 6: 4, 8
equal !!!
rank 7: 4, 8
equal !!!
rank 3: 0, 4
rank 0: round1 done !!!
rank 1: round1 done !!!
rank 2: round1 done !!!
rank 4: round1 done !!!
rank 6: round1 done !!!
rank 0: 4, 8
rank 1: 4, 8
rank 5: round1 done !!!
rank 2: 4, 8
rank 4: 0, 4
rank 6: 0, 4
rank 7: round1 done !!!
rank 5: 0, 4
rank 7: 0, 4
rank 3: round1 done !!!
rank 3: 4, 8
rank 7: round2 done !!!
rank 4: round2 done !!!
rank 2: round2 done !!!
rank 6: round2 done !!!
rank 5: round2 done !!!
rank 3: round2 done !!!
rank 0: round2 done !!!
rank 1: round2 done !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
8SC2: 0.5495383739471436, REAL_BD: 3.966989818178908 GB/s, TOTAL_BD: 0.4975767170470613 GB/s, comm_vol: 0.2734375 GB
equal !!!
equal !!!
equal !!!
GPU_NUM: 8
CUDA_VISIBLE_DEVICES: 
CONFIG:
WORLD_SIZE: 8

round 0:
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
8SC2: 0.5114812850952148, REAL_BD: 3.970040848144489 GB/s, TOTAL_BD: 0.5345992277099605 GB/s, comm_vol: 0.2734375 GB
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
GPU_NUM: 8
CUDA_VISIBLE_DEVICES: 
CONFIG:
WORLD_SIZE: 8

round 0:
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
8SC2: 0.38298559188842773, REAL_BD: 3.0642627332778543 GB/s, TOTAL_BD: 0.7139628899659977 GB/s, comm_vol: 0.2734375 GB
SIZE: [1, 1024, 1024, 128], in/out_dim: 2/1
8SC2: 0.5063252449035645, REAL_BD: 3.223466124018185 GB/s, TOTAL_BD: 1.0800863782807406 GB/s, comm_vol: 0.546875 GB
SIZE: [1, 1024, 1024, 256], in/out_dim: 2/1
8SC2: 0.7460041046142578, REAL_BD: 3.3107651372233384 GB/s, TOTAL_BD: 1.4661447480447227 GB/s, comm_vol: 1.09375 GB
SIZE: [1, 1024, 1024, 512], in/out_dim: 2/1
8SC2: 1.0883100032806396, REAL_BD: 3.3781964826756634 GB/s, TOTAL_BD: 2.009997145487888 GB/s, comm_vol: 2.1875 GB
SIZE: [1, 1024, 1024, 1024], in/out_dim: 2/1
8SC2: 1.7240610122680664, REAL_BD: 3.4583311916719177 GB/s, TOTAL_BD: 2.5376132102451088 GB/s, comm_vol: 4.375 GB
SIZE: [1, 1024, 1024, 2048], in/out_dim: 2/1
8SC2: 3.002187728881836, REAL_BD: 3.570258699264774 GB/s, TOTAL_BD: 2.9145412579708783 GB/s, comm_vol: 8.75 GB
SIZE: [1, 1024, 1024, 4096], in/out_dim: 2/1
8SC2: 5.663417339324951, REAL_BD: 3.628823203488205 GB/s, TOTAL_BD: 3.0900071372959963 GB/s, comm_vol: 17.5 GB

GPU_NUM: 8
CUDA_VISIBLE_DEVICES: 
CONFIG:
WORLD_SIZE: 8

round 0:
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
8SC3: 0.5741674900054932, REAL_BD: 3.969965372031016 GB/s, TOTAL_BD: 0.4762329890836975 GB/s, comm_vol: 0.2734375 GB
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
equal !!!
GPU_NUM: 8
CUDA_VISIBLE_DEVICES: 
CONFIG:
WORLD_SIZE: 8

round 0:
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
8SC3: 0.4719383716583252, REAL_BD: 2.216714211129339 GB/s, TOTAL_BD: 0.5793923876949845 GB/s, comm_vol: 0.2734375 GB
SIZE: [1, 1024, 1024, 128], in/out_dim: 2/1
8SC3: 0.5889763832092285, REAL_BD: 2.2939162781060896 GB/s, TOTAL_BD: 0.928517705616946 GB/s, comm_vol: 0.546875 GB
SIZE: [1, 1024, 1024, 256], in/out_dim: 2/1
8SC3: 0.8706529140472412, REAL_BD: 2.3528240299080565 GB/s, TOTAL_BD: 1.25624112933326 GB/s, comm_vol: 1.09375 GB
SIZE: [1, 1024, 1024, 512], in/out_dim: 2/1
8SC3: 1.3018016815185547, REAL_BD: 2.412766410488323 GB/s, TOTAL_BD: 1.6803634770607119 GB/s, comm_vol: 2.1875 GB
SIZE: [1, 1024, 1024, 1024], in/out_dim: 2/1
8SC3: 2.1880416870117188, REAL_BD: 2.4835068505240283 GB/s, TOTAL_BD: 1.9995048659128076 GB/s, comm_vol: 4.375 GB
SIZE: [1, 1024, 1024, 2048], in/out_dim: 2/1
8SC3: 3.964540958404541, REAL_BD: 2.556681794479807 GB/s, TOTAL_BD: 2.207065103325678 GB/s, comm_vol: 8.75 GB
SIZE: [1, 1024, 1024, 4096], in/out_dim: 2/1
8SC3: 7.629582643508911, REAL_BD: 2.578611823207405 GB/s, TOTAL_BD: 2.2937034458744128 GB/s, comm_vol: 17.5 GB

GPU_NUM: 8
CUDA_VISIBLE_DEVICES: 
CONFIG:
WORLD_SIZE: 8

round 0:
SIZE: [1, 1024, 1024, 64], in/out_dim: 2/1
8SC2: 0.42691898345947266, REAL_BD: 3.0506586474501125 GB/s, TOTAL_BD: 0.6404903754436991 GB/s, comm_vol: 0.2734375 GB
8SC3: 0.22905206680297852, REAL_BD: 2.4536935417703907 GB/s, TOTAL_BD: 1.1937787936888606 GB/s, comm_vol: 0.2734375 GB
SIZE: [1, 1024, 1024, 128], in/out_dim: 2/1
8SC2: 0.49781060218811035, REAL_BD: 3.2067405876164896 GB/s, TOTAL_BD: 1.0985603713465095 GB/s, comm_vol: 0.546875 GB
8SC3: 0.3792750835418701, REAL_BD: 2.513931077109553 GB/s, TOTAL_BD: 1.4418954044990084 GB/s, comm_vol: 0.546875 GB
SIZE: [1, 1024, 1024, 256], in/out_dim: 2/1
8SC2: 0.7486395835876465, REAL_BD: 3.2910368511460995 GB/s, TOTAL_BD: 1.460983394383861 GB/s, comm_vol: 1.09375 GB
8SC3: 0.6967034339904785, REAL_BD: 2.556206966548957 GB/s, TOTAL_BD: 1.569893223771519 GB/s, comm_vol: 1.09375 GB
SIZE: [1, 1024, 1024, 512], in/out_dim: 2/1
8SC2: 1.0854988098144531, REAL_BD: 3.374808154926776 GB/s, TOTAL_BD: 2.0152025780423606 GB/s, comm_vol: 2.1875 GB
8SC3: 1.1618075370788574, REAL_BD: 2.5705993466131125 GB/s, TOTAL_BD: 1.8828419769939262 GB/s, comm_vol: 2.1875 GB
SIZE: [1, 1024, 1024, 1024], in/out_dim: 2/1
8SC2: 1.726449728012085, REAL_BD: 3.458257405287191 GB/s, TOTAL_BD: 2.534102168753897 GB/s, comm_vol: 4.375 GB
8SC3: 2.07633113861084, REAL_BD: 2.5884820649522156 GB/s, TOTAL_BD: 2.107082015312391 GB/s, comm_vol: 4.375 GB
SIZE: [1, 1024, 1024, 2048], in/out_dim: 2/1
8SC2: 3.010446310043335, REAL_BD: 3.564698527108304 GB/s, TOTAL_BD: 2.906545773896909 GB/s, comm_vol: 8.75 GB
8SC3: 3.9334769248962402, REAL_BD: 2.594560100351688 GB/s, TOTAL_BD: 2.2244950630365814 GB/s, comm_vol: 8.75 GB
SIZE: [1, 1024, 1024, 4096], in/out_dim: 2/1
8SC2: 5.670210838317871, REAL_BD: 3.629739922277282 GB/s, TOTAL_BD: 3.0863049891794785 GB/s, comm_vol: 17.5 GB
8SC3: 7.601804494857788, REAL_BD: 2.5977737247155384 GB/s, TOTAL_BD: 2.302084986773576 GB/s, comm_vol: 17.5 GB

GPU_NUM: 8
CUDA_VISIBLE_DEVICES: 
srun: job 151623 queued and waiting for resources
GPU_NUM: 8
CUDA_VISIBLE_DEVICES: 
CONFIG:
WORLD_SIZE: 8

round 0:
SIZE: [1, 1024, 1024, 32], in/out_dim: 2/1
SC0: 0.4083824157714844, REAL_BD: 2.530167980962938 GB/s, TOTAL_BD: 0.3347811872402036 GB/s, comm_vol: 0.13671875 GB
SC1: 0.13173127174377441, REAL_BD: 3.5435967817099026 GB/s, TOTAL_BD: 1.0378610043781142 GB/s, comm_vol: 0.13671875 GB
SC2: 0.0948488712310791, REAL_BD: 7.923387720740719 GB/s, TOTAL_BD: 1.4414378181361152 GB/s, comm_vol: 0.13671875 GB
SC3: 0.11848711967468262, REAL_BD: 3.4927187815334255 GB/s, TOTAL_BD: 1.1538701453404725 GB/s, comm_vol: 0.13671875 GB
A2A: 0.1363697052001953, REAL_BD: 3.660887728808775 GB/s, TOTAL_BD: 1.002559547953061 GB/s, comm_vol: 0.13671875 GB
AGD: 0.5430352687835693, REAL_BD: 2.575769574002135 GB/s, TOTAL_BD: 0.25176771723549 GB/s, comm_vol: 0.13671875 GB

