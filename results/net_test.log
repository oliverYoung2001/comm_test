GPUs: 0, 1
SIZE: [1, 1024, 1024, 64]
time: 0.6200010776519775
BD: 8.064502111731212 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2139370441436768
BD: 8.237659480153766 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.428607702255249
BD: 8.2351711152969 GB/s
SIZE: [1, 1024, 1024, 512]
time: 4.850018501281738
BD: 8.24739121911164 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 9.701671600341797
BD: 8.246001647507997 GB/s
GPUs: 0, 2
SIZE: [1, 1024, 1024, 64]
time: 0.6455466747283936
BD: 7.745373333545081 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.267411231994629
BD: 7.8900989257150425 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.5195484161376953
BD: 7.9379304132042465 GB/s
SIZE: [1, 1024, 1024, 512]
time: 4.978202819824219
BD: 8.035028191441265 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.009053468704224
BD: 7.992763776329075 GB/s
GPUs: 0, 3
SIZE: [1, 1024, 1024, 64]
time: 0.647728681564331
BD: 7.719281455816482 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2200217247009277
BD: 8.196575353976888 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.4382667541503906
BD: 8.202547964022486 GB/s
SIZE: [1, 1024, 1024, 512]
time: 4.847832441329956
BD: 8.251110260945072 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 9.719603300094604
BD: 8.230788595993555 GB/s
GPUs: 0, 4
SIZE: [1, 1024, 1024, 64]
time: 0.6479747295379639
BD: 7.716350302063836 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2628986835479736
BD: 7.918291570235952 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.535433292388916
BD: 7.888198068565928 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.062535524368286
BD: 7.901179124069709 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.144580602645874
BD: 7.885983968537317 GB/s
GPUs: 0, 5
SIZE: [1, 1024, 1024, 64]
time: 0.6434464454650879
BD: 7.770654473638381 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.266664981842041
BD: 7.89474734310374 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.5404229164123535
BD: 7.872704922786825 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.036377668380737
BD: 7.942216139017337 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 9.710680723190308
BD: 8.238351386525364 GB/s
GPUs: 0, 6
SIZE: [1, 1024, 1024, 64]
time: 0.6533074378967285
BD: 7.653364572271063 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2623424530029297
BD: 7.92178063584208 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.5262444019317627
BD: 7.916890378740255 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.049311637878418
BD: 7.921871904267509 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.099182844161987
BD: 7.921432974772353 GB/s
GPUs: 0, 7
SIZE: [1, 1024, 1024, 64]
time: 0.6405613422393799
BD: 7.805653682628078 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.266188621520996
BD: 7.897717472762946 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.5334596633911133
BD: 7.894343173883175 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.035906791687012
BD: 7.9429587668361386 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.17033576965332
BD: 7.866013651064245 GB/s
GPUs: 1, 2
SIZE: [1, 1024, 1024, 64]
time: 0.653393030166626
BD: 7.652362007481037 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2209162712097168
BD: 8.190569849717647 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.462886333465576
BD: 8.120553404451112 GB/s
SIZE: [1, 1024, 1024, 512]
time: 4.930863857269287
BD: 8.112168812170776 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 9.927711248397827
BD: 8.058252098429103 GB/s
GPUs: 1, 3
SIZE: [1, 1024, 1024, 64]
time: 0.6537401676177979
BD: 7.648298586607877 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2236201763153076
BD: 8.172470668237132 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.4804999828338623
BD: 8.062890602059541 GB/s
SIZE: [1, 1024, 1024, 512]
time: 4.94547176361084
BD: 8.0882071341147 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.115138292312622
BD: 7.908937840306049 GB/s
GPUs: 1, 4
SIZE: [1, 1024, 1024, 64]
time: 0.6403706073760986
BD: 7.80797860240239 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2560844421386719
BD: 7.961248196795991 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.521498441696167
BD: 7.931791536839641 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.035647869110107
BD: 7.943367177313918 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.05664587020874
BD: 7.954938558290856 GB/s
GPUs: 1, 5
SIZE: [1, 1024, 1024, 64]
time: 0.6406042575836182
BD: 7.805130766473792 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2636041641235352
BD: 7.91387072306479 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.5343739986419678
BD: 7.891495103215589 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.049511194229126
BD: 7.921558832410218 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.163318872451782
BD: 7.87144445667687 GB/s
GPUs: 1, 6
SIZE: [1, 1024, 1024, 64]
time: 0.6417152881622314
BD: 7.791617392066799 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2703309059143066
BD: 7.871964661682076 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.520703077316284
BD: 7.934294276854453 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.047410249710083
BD: 7.924856118501077 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.092792272567749
BD: 7.926448681346621 GB/s
GPUs: 1, 7
SIZE: [1, 1024, 1024, 64]
time: 0.6663639545440674
BD: 7.5034070584160695 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2581932544708252
BD: 7.947904635846924 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.5563278198242188
BD: 7.823722702894679 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.040154457092285
BD: 7.936264719767417 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.161032676696777
BD: 7.873215503328839 GB/s
GPUs: 2, 3
SIZE: [1, 1024, 1024, 64]
time: 0.6293251514434814
BD: 7.945018546504161 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2369108200073242
BD: 8.084657226897559 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.4775640964508057
BD: 8.072445039323373 GB/s
SIZE: [1, 1024, 1024, 512]
time: 4.956302165985107
BD: 8.07053296195666 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 9.913329362869263
BD: 8.06994270760769 GB/s
GPUs: 2, 4
SIZE: [1, 1024, 1024, 64]
time: 0.6517181396484375
BD: 7.672028283112079 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.261160135269165
BD: 7.9292071802330915 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.519390344619751
BD: 7.938428454610348 GB/s
SIZE: [1, 1024, 1024, 512]
time: 4.871625900268555
BD: 8.210811096516041 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 9.794401168823242
BD: 8.167931721507347 GB/s
GPUs: 2, 5
SIZE: [1, 1024, 1024, 64]
time: 0.6413705348968506
BD: 7.7958055881131685 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2613558769226074
BD: 7.92797669789869 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.5244290828704834
BD: 7.922583421221861 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.079019069671631
BD: 7.875536486730711 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.14487910270691
BD: 7.885751933569518 GB/s
GPUs: 2, 6
SIZE: [1, 1024, 1024, 64]
time: 0.6413583755493164
BD: 7.79595338677468 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2373652458190918
BD: 8.081688114151255 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.4883885383605957
BD: 8.037330059869362 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.030738592147827
BD: 7.951118760659431 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.081122159957886
BD: 7.935624499994573 GB/s
GPUs: 2, 7
SIZE: [1, 1024, 1024, 64]
time: 0.6482696533203125
BD: 7.712839825820878 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2609875202178955
BD: 7.930292599780865 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.51933217048645
BD: 7.938611761599607 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.0669028759002686
BD: 7.894368804709513 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.114114046096802
BD: 7.909738770532578 GB/s
GPUs: 3, 4
SIZE: [1, 1024, 1024, 64]
time: 0.6416919231414795
BD: 7.791901097214848 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2510147094726562
BD: 7.993511126831857 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.517308473587036
BD: 7.944993714457657 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.061085224151611
BD: 7.903443279144779 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.094794988632202
BD: 7.924876145586749 GB/s
GPUs: 3, 5
SIZE: [1, 1024, 1024, 64]
time: 0.6488702297210693
BD: 7.705701033855963 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2693212032318115
BD: 7.878226547022973 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.549795150756836
BD: 7.84376736855255 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.044873952865601
BD: 7.928840318652384 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.176621913909912
BD: 7.861154779726269 GB/s
GPUs: 3, 6
SIZE: [1, 1024, 1024, 64]
time: 0.6469995975494385
BD: 7.7279800774805585 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2741670608520508
BD: 7.848264413076948 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.5459539890289307
BD: 7.8556015097619 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.104901313781738
BD: 7.835606908210295 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.220414876937866
BD: 7.8274708965599995 GB/s
GPUs: 3, 7
SIZE: [1, 1024, 1024, 64]
time: 0.6494848728179932
BD: 7.698408707051077 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.250786304473877
BD: 7.9949708149437555 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.492565393447876
BD: 8.023861701912951 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.051795959472656
BD: 7.9179761654854115 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.099990367889404
BD: 7.920799633071097 GB/s
GPUs: 4, 5
SIZE: [1, 1024, 1024, 64]
time: 0.6182413101196289
BD: 8.087456981857953 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2128901481628418
BD: 8.244769746993944 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.419434070587158
BD: 8.266395949010636 GB/s
SIZE: [1, 1024, 1024, 512]
time: 4.844767808914185
BD: 8.256329627686503 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 9.670300722122192
BD: 8.272752037275179 GB/s
GPUs: 4, 6
SIZE: [1, 1024, 1024, 64]
time: 0.6453185081481934
BD: 7.748111880981075 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2542486190795898
BD: 7.972900944741194 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.492828130722046
BD: 8.023016008812053 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.005590915679932
BD: 7.991064526407992 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 9.986225366592407
BD: 8.011034906905806 GB/s
GPUs: 4, 7
SIZE: [1, 1024, 1024, 64]
time: 0.6530232429504395
BD: 7.656695307519812 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2416479587554932
BD: 8.053812620143173 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.494680643081665
BD: 8.01705823768052 GB/s
SIZE: [1, 1024, 1024, 512]
time: 4.998264789581299
BD: 8.002777300510077 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.038187265396118
BD: 7.969566405259038 GB/s
GPUs: 5, 6
SIZE: [1, 1024, 1024, 64]
time: 0.6548480987548828
BD: 7.635358504524814 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2425901889801025
BD: 8.047705582005145 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.5007011890411377
BD: 7.997756824224468 GB/s
SIZE: [1, 1024, 1024, 512]
time: 5.003666877746582
BD: 7.994137295169844 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 10.057671546936035
BD: 7.954127317308465 GB/s
GPUs: 5, 7
SIZE: [1, 1024, 1024, 64]
time: 0.643963098526001
BD: 7.764420059852417 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2427868843078613
BD: 8.046431875219898 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.4838273525238037
BD: 8.052089441594283 GB/s
SIZE: [1, 1024, 1024, 512]
time: 4.976433753967285
BD: 8.037884552991672 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 9.92715334892273
BD: 8.05870496688574 GB/s
GPUs: 6, 7
SIZE: [1, 1024, 1024, 64]
time: 0.630363941192627
BD: 7.93192578645944 GB/s
SIZE: [1, 1024, 1024, 128]
time: 1.2329521179199219
BD: 8.11061504713639 GB/s
SIZE: [1, 1024, 1024, 256]
time: 2.4666686058044434
BD: 8.10810173402985 GB/s
SIZE: [1, 1024, 1024, 512]
time: 4.92486834526062
BD: 8.122044529067148 GB/s
SIZE: [1, 1024, 1024, 1024]
time: 9.848273992538452
BD: 8.123250841783243 GB/s
srun: error: Unable to allocate resources: Invalid node name specified
GPUs: 0, 11
GPUs: 0, 11
Traceback (most recent call last):
  File "net_test.py", line 68, in <module>
    main()
  File "net_test.py", line 65, in main
    torch.multiprocessing.spawn(net_test, nprocs=args.gpus, args=(args.gpus, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/net_test.py", line 31, in net_test
    torch.cuda.set_device(rank)
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/cuda/__init__.py", line 314, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: CUDA error: invalid device ordinal
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.

GPUs: 0, 15
Traceback (most recent call last):
  File "net_test.py", line 68, in <module>
    main()
  File "net_test.py", line 65, in main
    torch.multiprocessing.spawn(net_test, nprocs=args.gpus, args=(args.gpus, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/net_test.py", line 31, in net_test
    torch.cuda.set_device(rank)
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/cuda/__init__.py", line 314, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: CUDA error: invalid device ordinal
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.

GPUs: 4, 11
Traceback (most recent call last):
  File "net_test.py", line 68, in <module>
    main()
  File "net_test.py", line 65, in main
    torch.multiprocessing.spawn(net_test, nprocs=args.gpus, args=(args.gpus, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/net_test.py", line 31, in net_test
    torch.cuda.set_device(rank)
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/cuda/__init__.py", line 314, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: CUDA error: invalid device ordinal
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.

GPUs: 0, 15
Traceback (most recent call last):
  File "net_test.py", line 68, in <module>
    main()
  File "net_test.py", line 65, in main
    torch.multiprocessing.spawn(net_test, nprocs=args.gpus, args=(args.gpus, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/net_test.py", line 31, in net_test
    torch.cuda.set_device(rank)
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/cuda/__init__.py", line 314, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: CUDA error: invalid device ordinal
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.

GPUs: 4, 15
Traceback (most recent call last):
  File "net_test.py", line 68, in <module>
    main()
  File "net_test.py", line 65, in main
    torch.multiprocessing.spawn(net_test, nprocs=args.gpus, args=(args.gpus, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/net_test.py", line 31, in net_test
    torch.cuda.set_device(rank)
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/cuda/__init__.py", line 314, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: CUDA error: invalid device ordinal
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.

Traceback (most recent call last):
  File "net_test.py", line 68, in <module>
    main()
  File "net_test.py", line 65, in main
    torch.multiprocessing.spawn(net_test, nprocs=args.gpus, args=(args.gpus, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/net_test.py", line 31, in net_test
    torch.cuda.set_device(rank)
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/cuda/__init__.py", line 314, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: CUDA error: invalid device ordinal
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.

GPUs: 4, 11
srun: error: nico3: task 0: Exited with exit code 1
Traceback (most recent call last):
  File "net_test.py", line 68, in <module>
    main()
  File "net_test.py", line 65, in main
    torch.multiprocessing.spawn(net_test, nprocs=args.gpus, args=(args.gpus, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/net_test.py", line 31, in net_test
    torch.cuda.set_device(rank)
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/cuda/__init__.py", line 314, in set_device
    torch._C._cuda_setDevice(device)
RuntimeError: CUDA error: invalid device ordinal
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.

