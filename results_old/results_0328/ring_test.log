GPU_NUM: 4
CUDA_VISIBLE_DEVICES: 0,1,2,3
SIZE: [1, 1024, 1024, 64]
Offset: 1: 5.3590710163116455, BD: 2.7989925780688156 GB/s
Offset: 2: 9.015787839889526, BD: 1.6637481123539615 GB/s
Offset: 3: 14.397979974746704, BD: 1.0418128116797778 GB/s
SIZE: [1, 1024, 1024, 128]
Offset: 1: 10.682778120040894, BD: 2.8082582697959433 GB/s
Offset: 2: 18.06915545463562, BD: 1.660287890893292 GB/s
Offset: 3: 28.759178638458252, BD: 1.0431452294636279 GB/s
SIZE: [1, 1024, 1024, 256]
Offset: 1: 21.340781211853027, BD: 2.811518444632898 GB/s
Offset: 2: 36.10213041305542, BD: 1.6619517827209034 GB/s
Offset: 3: 57.44843912124634, BD: 1.04441479904038 GB/s
SIZE: [1, 1024, 1024, 512]
Offset: 1: 42.64680004119873, BD: 2.8138101776469653 GB/s
Offset: 2: 72.15022850036621, BD: 1.6631963958283364 GB/s
Offset: 3: 114.76493906974792, BD: 1.0456155074248807 GB/s
SIZE: [1, 1024, 1024, 1024]
Offset: 1: 85.16318678855896, BD: 2.8181190611838662 GB/s
Offset: 2: 144.09894847869873, BD: 1.6655222160450236 GB/s
Offset: 3: 229.33767867088318, BD: 1.046491799301841 GB/s
SIZE: [1, 1024, 1024, 2048]
Traceback (most recent call last):
  File "ring_test.py", line 73, in <module>
    main()
  File "ring_test.py", line 70, in main
    torch.multiprocessing.spawn(net_test, nprocs=args.gpus, args=(args.gpus, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 2 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/ring_test.py", line 40, in net_test
    send_buf = torch.randn(SIZE, dtype=torch.float32).cuda()
RuntimeError: CUDA out of memory. Tried to allocate 8.00 GiB (GPU 2; 15.77 GiB total capacity; 8.00 GiB already allocated; 7.03 GiB free; 8.00 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

srun: error: nico3: task 0: Exited with exit code 1
GPU_NUM: 8
CUDA_VISIBLE_DEVICES: 
SIZE: [1, 1024, 1024, 64]
Offset: 7: 12.66580319404602, BD: 2.7633462689877346 GB/s
Offset: 6: 10.236332893371582, BD: 3.419193217393686 GB/s
Offset: 5: 10.157182693481445, BD: 3.4458373996228184 GB/s
Offset: 4: 10.542288064956665, BD: 3.3199624013635667 GB/s
Offset: 3: 10.083309650421143, BD: 3.4710825327612724 GB/s
Offset: 2: 10.26473593711853, BD: 3.40973213674555 GB/s
Offset: 1: 12.690316438674927, BD: 2.758008452282106 GB/s
SIZE: [1, 1024, 1024, 128]
Offset: 7: 25.37418270111084, BD: 2.7587095444431995 GB/s
Offset: 6: 20.631181240081787, BD: 3.392922546965251 GB/s
Offset: 5: 20.758017539978027, BD: 3.3721910035573703 GB/s
Offset: 4: 21.27484703063965, BD: 3.2902704258783753 GB/s
Offset: 3: 20.7529239654541, BD: 3.3730186703581606 GB/s
Offset: 2: 20.714350700378418, BD: 3.3792997430868645 GB/s
Offset: 1: 25.390933513641357, BD: 2.756889578809392 GB/s
SIZE: [1, 1024, 1024, 256]
Offset: 7: 50.75056338310242, BD: 2.758590066147197 GB/s
Offset: 6: 41.26148009300232, BD: 3.3929951054698857 GB/s
Offset: 5: 41.48008346557617, BD: 3.3751137486544436 GB/s
Offset: 4: 42.54977822303772, BD: 3.290263917855154 GB/s
Offset: 3: 41.54704213142395, BD: 3.3696742973216742 GB/s
Offset: 2: 41.43100953102112, BD: 3.3791114815866647 GB/s
Offset: 1: 50.75570344924927, BD: 2.7583107017714035 GB/s
SIZE: [1, 1024, 1024, 512]
Offset: 7: 101.49275875091553, BD: 2.7588175101947776 GB/s
Offset: 6: 82.51764845848083, BD: 3.3932135152988927 GB/s
Offset: 5: 83.02159094810486, BD: 3.3726166507098427 GB/s
Offset: 4: 85.09952330589294, BD: 3.290265199177804 GB/s
Offset: 3: 83.04327392578125, BD: 3.37173604511602 GB/s
Offset: 2: 82.82877397537231, BD: 3.3804677597093624 GB/s
Offset: 1: 101.48508524894714, BD: 2.759026110222486 GB/s
SIZE: [1, 1024, 1024, 1024]
Offset: 7: 203.01810431480408, BD: 2.758374687272483 GB/s
Offset: 6: 164.95512104034424, BD: 3.394862775209245 GB/s
Offset: 5: 165.91896271705627, BD: 3.3751416404101753 GB/s
Offset: 4: 170.17335748672485, BD: 3.2907618928755364 GB/s
Offset: 3: 166.04124641418457, BD: 3.3726559640674942 GB/s
Offset: 2: 165.6387858390808, BD: 3.3808506695046883 GB/s
Offset: 1: 202.89645910263062, BD: 2.760028452328666 GB/s
SIZE: [1, 1024, 1024, 2048]
Traceback (most recent call last):
  File "ring_test.py", line 74, in <module>
    main()
  File "ring_test.py", line 71, in main
    torch.multiprocessing.spawn(net_test, nprocs=args.gpus, args=(args.gpus, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/ring_test.py", line 40, in net_test
    send_buf = torch.randn(SIZE, dtype=torch.float32).cuda()
RuntimeError: CUDA out of memory. Tried to allocate 8.00 GiB (GPU 1; 15.77 GiB total capacity; 8.00 GiB already allocated; 7.03 GiB free; 8.00 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

srun: error: nico3: task 0: Exited with exit code 1
GPU_NUM: 4
CUDA_VISIBLE_DEVICES: 0,1,2,3
SIZE: [1, 1024, 1024, 64]
Offset: 3: 5.36249566078186, BD: 2.797205060640175 GB/s
Offset: 2: 3.6820194721221924, BD: 4.073851350751957 GB/s
Offset: 1: 5.3553853034973145, BD: 2.8009189161803736 GB/s
SIZE: [1, 1024, 1024, 128]
Offset: 3: 10.687042474746704, BD: 2.8071377156860264 GB/s
Offset: 2: 7.393602132797241, BD: 4.057562127521463 GB/s
Offset: 1: 10.705597639083862, BD: 2.8022723262526115 GB/s
SIZE: [1, 1024, 1024, 256]
Offset: 3: 21.30809235572815, BD: 2.8158316098095235 GB/s
Offset: 2: 14.777736902236938, BD: 4.060161606403865 GB/s
Offset: 1: 21.374895334243774, BD: 2.80703128889135 GB/s
SIZE: [1, 1024, 1024, 512]
Offset: 3: 42.591607093811035, BD: 2.817456494085595 GB/s
Offset: 2: 29.52619433403015, BD: 4.064187840885917 GB/s
Offset: 1: 42.67090368270874, BD: 2.8122207322416477 GB/s
SIZE: [1, 1024, 1024, 1024]
Offset: 3: 85.09353613853455, BD: 2.8204257443159206 GB/s
Offset: 2: 59.0229606628418, BD: 4.06621418689851 GB/s
Offset: 1: 85.27337765693665, BD: 2.8144774675813133 GB/s
SIZE: [1, 1024, 1024, 2048]
Traceback (most recent call last):
  File "ring_test.py", line 74, in <module>
    main()
  File "ring_test.py", line 71, in main
    torch.multiprocessing.spawn(net_test, nprocs=args.gpus, args=(args.gpus, args))
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/home/yhy/.local/anaconda3/envs/fastfold/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/yhy/fold/comm_test/ring_test.py", line 40, in net_test
    send_buf = torch.randn(SIZE, dtype=torch.float32).cuda()
RuntimeError: CUDA out of memory. Tried to allocate 8.00 GiB (GPU 1; 15.77 GiB total capacity; 8.00 GiB already allocated; 7.03 GiB free; 8.00 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

srun: error: nico3: task 0: Exited with exit code 1
